[activeannoservice](../../index.md) / [document](../index.md) / [DocumentDAO](./index.md)

# DocumentDAO

`class DocumentDAO`

This DAO provides all methods to interact with the document collection. It hides the collection and controls
access to it via the public methods.

### Constructors

| Name | Summary |
|---|---|
| [&lt;init&gt;](-init-.md) | This DAO provides all methods to interact with the document collection. It hides the collection and controls access to it via the public methods.`DocumentDAO(database: CoroutineDatabase)` |

### Functions

| Name | Summary |
|---|---|
| [aggregateOptionsForSubFilterForAnnotation](aggregate-options-for-sub-filter-for-annotation.md) | `suspend fun aggregateOptionsForSubFilterForAnnotation(project: `[`Project`](../../project/-project/index.md)`, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`): `[`Map`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`SubFilterOption`](../../project.selection/-sub-filter-option/index.md)`>>` |
| [aggregateOptionsForSubFilterForCuration](aggregate-options-for-sub-filter-for-curation.md) | `suspend fun aggregateOptionsForSubFilterForCuration(project: `[`Project`](../../project/-project/index.md)`, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`): `[`Map`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`SubFilterOption`](../../project.selection/-sub-filter-option/index.md)`>>` |
| [aggregateValuesForProjectAndAnnotation](aggregate-values-for-project-and-annotation.md) | Get unique list of values for a project and annotation over all existing annotations.`suspend fun aggregateValuesForProjectAndAnnotation(projectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, annotationID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`>` |
| [bulkReplace](bulk-replace.md) | `suspend fun bulkReplace(documents: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>): BulkWriteResult` |
| [byId](by-id.md) | `suspend fun byId(id: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): `[`Document`](../-document/index.md) |
| [byIdOrNull](by-id-or-null.md) | `suspend fun byIdOrNull(id: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): `[`Document`](../-document/index.md)`?` |
| [countAll](count-all.md) | `suspend fun countAll(): `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html) |
| [countForAnnotation](count-for-annotation.md) | Count number of annotations required by the user given its [userIdentifier](count-for-annotation.md#document.DocumentDAO$countForAnnotation(kotlin.collections.List((project.Project)), kotlin.String, kotlin.Boolean)/userIdentifier) and a list of [projects](count-for-annotation.md#document.DocumentDAO$countForAnnotation(kotlin.collections.List((project.Project)), kotlin.String, kotlin.Boolean)/projects).`suspend fun countForAnnotation(projects: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Project`](../../project/-project/index.md)`>, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`, includeMissingProjectAnnotationData: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)` = true): `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html) |
| [countForCuration](count-for-curation.md) | Count number of curations required given a list of [projects](count-for-curation.md#document.DocumentDAO$countForCuration(kotlin.collections.List((project.Project)), kotlin.String)/projects) and a [userIdentifier](count-for-curation.md#document.DocumentDAO$countForCuration(kotlin.collections.List((project.Project)), kotlin.String)/userIdentifier).`suspend fun countForCuration(projects: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Project`](../../project/-project/index.md)`>, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`): `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html) |
| [createSparseIndexes](create-sparse-indexes.md) | `suspend fun createSparseIndexes(indexes: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<BsonDocument>): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [deleteById](delete-by-id.md) | `suspend fun deleteById(id: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): DeleteResult` |
| [dropIndexes](drop-indexes.md) | `suspend fun dropIndexes(indexes: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<BsonDocument>): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [findFailedWebHookDocuments](find-failed-web-hook-documents.md) | Get all documents with failed webhook tries for resend purposes given a [projectID](find-failed-web-hook-documents.md#document.DocumentDAO$findFailedWebHookDocuments(kotlin.String)/projectID)`suspend fun findFailedWebHookDocuments(projectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForAnnotation](find-for-annotation.md) | Encapsulates the query for getting new documents to annotate. Will use the projects filterCondition, will optionally exclude some documents, and only return documents that are required for annotation and not already annotated by the user`suspend fun findForAnnotation(project: `[`Project`](../../project/-project/index.md)`, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`, limit: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = 10, ignoreDocuments: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`> = listOf(), subFilter: `[`Map`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`> = mapOf(), dateRange: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`?>? = null, includeMissingProjectAnnotationData: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)` = true): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForCuration](find-for-curation.md) | Encapsulates the query for getting new documents to curate. Will use the projects filterCondition, will optionally exclude some documents, and only return documents that are required for curation. If a curator is also an annotator, and the curator annotated a document, the curator will not be able to curate the document.`suspend fun findForCuration(project: `[`Project`](../../project/-project/index.md)`, userIdentifier: `[`UserIdentifier`](../../project.userroles/-user-identifier.md)`, limit: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = 10, ignoreDocuments: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`> = listOf(), subFilter: `[`Map`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-map/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`> = mapOf(), dateRange: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`?>? = null): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForExport](find-for-export.md) | Get all documents for an export for a [projectID](find-for-export.md#document.DocumentDAO$findForExport(kotlin.String, kotlin.Boolean, kotlin.collections.List((kotlin.String)), kotlin.Long)/projectID) with options to also include unfinished documents, limit it to a list of [documentIDs](find-for-export.md#document.DocumentDAO$findForExport(kotlin.String, kotlin.Boolean, kotlin.collections.List((kotlin.String)), kotlin.Long)/documentIDs) and/or only return documents newer than a [timestamp](find-for-export.md#document.DocumentDAO$findForExport(kotlin.String, kotlin.Boolean, kotlin.collections.List((kotlin.String)), kotlin.Long)/timestamp). If unfinished documents are included, the annotation timestamp will be used, else the finalizedAnnotation timestamp.`suspend fun findForExport(projectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, includeUnfinished: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)`, documentIDs: `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`>, timestamp: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`?): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForFilter](find-for-filter.md) | `suspend fun findForFilter(filter: `[`FilterCondition`](../../project.filter/-filter-condition/index.md)`): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForProject](find-for-project.md) | Given a [project](find-for-project.md#document.DocumentDAO$findForProject(project.Project)/project), find all documents for that project.`suspend fun findForProject(project: `[`Project`](../../project/-project/index.md)`): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForProjectAndMissingGeneratedAnnotationData](find-for-project-and-missing-generated-annotation-data.md) | `suspend fun findForProjectAndMissingGeneratedAnnotationData(project: `[`Project`](../../project/-project/index.md)`, limit: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = Int.MAX_VALUE): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForProjectAndMissingProjectAnnotationData](find-for-project-and-missing-project-annotation-data.md) | `suspend fun findForProjectAndMissingProjectAnnotationData(project: `[`Project`](../../project/-project/index.md)`, limit: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = 10): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForRestrictedProject](find-for-restricted-project.md) | Given a [projectID](find-for-restricted-project.md#document.DocumentDAO$findForRestrictedProject(kotlin.String)/projectID), find all documents that are restricted to that project.`suspend fun findForRestrictedProject(projectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [findForSearch](find-for-search.md) | Find documents for a given [project](find-for-search.md#document.DocumentDAO$findForSearch(project.Project, project.filter.FilterCondition)/project) and an optional additional searchFilter`suspend fun findForSearch(project: `[`Project`](../../project/-project/index.md)`, searchFilter: `[`FilterCondition`](../../project.filter/-filter-condition/index.md)`?): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [getAll](get-all.md) | `suspend fun getAll(batchSize: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = 10_000): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`Document`](../-document/index.md)`>` |
| [getAllIndexes](get-all-indexes.md) | `suspend fun getAllIndexes(): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<BsonDocument>` |
| [insert](insert.md) | Given the originalDocument, create a new document entry into the database. Provide [restrictedProjectID](insert.md#document.DocumentDAO$insert(com.fasterxml.jackson.databind.node.ObjectNode, kotlin.String)/restrictedProjectID) optionally (only used in one-off project context)`suspend fun insert(json: ObjectNode, restrictedProjectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`? = null): `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html) |
| [insertMany](insert-many.md) | Given an json array of originalDocuments, create new document entries into the database. Provide [restrictedProjectID](insert-many.md#document.DocumentDAO$insertMany(com.fasterxml.jackson.databind.node.ArrayNode, kotlin.String)/restrictedProjectID) optionally (only used in one-off project context)`suspend fun insertMany(json: ArrayNode, restrictedProjectID: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`? = null): `[`List`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html)`<`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`>` |
| [save](save.md) | `suspend fun save(document: `[`Document`](../-document/index.md)`): UpdateResult?` |
| [update](update.md) | `suspend fun update(id: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, document: `[`Document`](../-document/index.md)`): UpdateResult` |
| [updateAndValidate](update-and-validate.md) | `suspend fun updateAndValidate(id: `[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`, document: `[`Document`](../-document/index.md)`): `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html) |
